<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-02-15 Sat 12:29 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<link rel="stylesheet" type="text/css" href="org-html-themes/src/readtheorg_theme/css/search.css"/>
<script type="text/javascript" src="org-html-themes/src/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="org-html-themes/src/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="org-html-themes/src/readtheorg_theme/js/search.js"></script>
<script type="text/javascript" src="org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org11d2e16">1. Purpose</a></li>
<li><a href="#org7d1db29">2. create the mesh</a></li>
<li><a href="#org8b215aa">3. automate export of mesh to elmer</a></li>
<li><a href="#orgabacd5d">4. write the sif file</a>
<ul>
<li><a href="#orgede5682">4.1. checking the results with plot</a></li>
</ul>
</li>
<li><a href="#org097e0b5">5. results exported with paraview</a></li>
<li><a href="#org80297f7">6. final</a></li>
<li><a href="#org57b66e0">7. add a hole</a></li>
</ul>
</div>
</div>


<div id="outline-container-org11d2e16" class="outline-2">
<h2 id="org11d2e16"><span class="section-number-2">1.</span> Purpose</h2>
<div class="outline-text-2" id="text-1">

<div id="org9b4e47d" class="figure">
<p><img src="./pressure_on_walls.png" alt="pressure_on_walls.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-org7d1db29" class="outline-2">
<h2 id="org7d1db29"><span class="section-number-2">2.</span> create the mesh</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-txt">//+
SetFactory("OpenCASCADE");

Mesh.MeshSizeFromCurvature = 100;

//εξωτερικός κυκλος
//+
Circle(1) = {0, 0, 0, 1.65, 0, 2*Pi};

//+
Curve Loop(1) = {1};


Plane Surface(8) = {1};

//+00
Extrude {0, 0, 3} {Curve{1};}

//+
//+
</pre>
</div>
</div>
</div>


<div id="outline-container-org8b215aa" class="outline-2">
<h2 id="org8b215aa"><span class="section-number-2">3.</span> automate export of mesh to elmer</h2>
<div class="outline-text-2" id="text-3">
<p>
For converting the .geo file to elmer mesh by scripting we need the following script:
</p>

<div class="org-src-container">
<pre class="src src-txt">gmsh -2 cylinder_shell.geo -o cylinder_shell.msh
ElmerGrid 14 2 cylinder_shell.msh -autoclean
</pre>
</div>
</div>
</div>


<div id="outline-container-orgabacd5d" class="outline-2">
<h2 id="orgabacd5d"><span class="section-number-2">4.</span> write the sif file</h2>
<div class="outline-text-2" id="text-4">
<p>
the full sif file is included.
</p>

<p>
to mention what to change each time we have:
</p>


<p>
We need to elmergui to find boundary conditions and bodies.
</p>

<p>
On shells the mesh is 2d, that's why it is rendered with <i>gmsh -2</i> command.
</p>

<p>
So we have only surface and curve boundaries.
</p>

<p>
The surfaces are the bodies.
</p>

<p>
So we apply a normal pressure on surface 2, which is the cylinder:
</p>

<div class="org-src-container">
<pre class="src src-txt">Body Force 2 
Normal Pressure = Variable Coordinate 3; Real MATC "-2000*(3.0-tx)"
End
</pre>
</div>


<p>
the solver I used is <i>iterative</i>
</p>

<div class="org-src-container">
<pre class="src src-txt">Solver 1
  Equation = "Shell equations"
  Procedure = "ShellSolver" "ShellSolver"
  Large Deflection = True
  Displace Mesh = True
  Linear System Solver = "Iterative"
  Linear System Preconditioning = ILU2
  Linear System Max Iterations = 10000
  Linear System Convergence Tolerance = 1e-5
  Linear System Iterative Method = GCR
  Linear System GCR Restart = 100
  Linear System Abort Not Converged = False
  Steady State Convergence Tolerance = 1e-09
  Nonlinear System Convergence Tolerance = 1e-8
End
</pre>
</div>


<p>
the boundary condition at the base where it touches the ground, and the tank has max pressure is:
</p>

<p>
if the connection is to stiff, uncomment the DNU part.
</p>

<div class="org-src-container">
<pre class="src src-txt">Boundary Condition 1
  Target Boundaries(1) = 1
  U 1 = Real 0
  U 2 = Real 0
  U 3 = Real 0
  !DNU 1 = Real 0
  !DNU 2 = Real 0
  !DNU 3 = Real 0
End
</pre>
</div>


<p>
These are enough to check the results on paraview.
</p>
</div>

<div id="outline-container-orgede5682" class="outline-3">
<h3 id="orgede5682"><span class="section-number-3">4.1.</span> checking the results with plot</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Add a second solver
</p>

<div class="org-src-container">
<pre class="src src-txt">Solver 3
Equation = "SaveLine"
Procedure = File "SaveData" "SaveLine"
Filename = "g5.dat"
File Append = Logical True
Polyline Coordinates(2,2) = Real 0.0 1.0 0.0 2.0
End
</pre>
</div>


<p>
It applies to a vertical line on cylinder wall, need to check to GUI to see the line and the number
</p>

<div class="org-src-container">
<pre class="src src-txt">Boundary Condition 4
  Target Boundaries(1) = 2
  Save Line = Logical True 
End
</pre>
</div>

<p>
Now it exports the pressure on wall as g5.dat
</p>

<p>
The .dat file has the following columns:
</p>

<div class="org-src-container">
<pre class="src src-txt">Data on different columns
  1: Call count
  2: Boundary condition
  3: Node index
  4: coordinate 1
  5: coordinate 2
  6: coordinate 3
  7: u 1
  8: u 2
  9: u 3
 10: dnu 1
 11: dnu 2
 12: dnu 3
</pre>
</div>

<p>
the line is vertical on z axis, so we need the column 6 as abscissa.
</p>

<p>
The deflection is described at column 7 <i>u 1</i> variable. This variable is \(\delta R\), change of diameter, due to pressure. 
</p>

<p>
to plot the results I need:
</p>



<div class="org-src-container">
<pre class="src src-txt">plot "g1.dat" using 6:7 with lines,\
         "g4.dat" using 6:7 with lines
</pre>
</div>
<p>
each dat, file is for different <i>pressure</i>, <i>material</i> etc. This helps compare results.
</p>

<p>
the plot is give as follows:
</p>


<div id="org4e4233b" class="figure">
<p><img src="./plt.png" alt="plt.png" />
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-org097e0b5" class="outline-2">
<h2 id="org097e0b5"><span class="section-number-2">5.</span> results exported with paraview</h2>
<div class="outline-text-2" id="text-5">
<p>
the whole procedure is hard to follow, even on simpler geometries, without using <i>gmsh</i>, <i>ElmerGUI</i> and <i>paraview</i>.
</p>

<p>
paraview has also functions like <i>plot over line</i> and <i>wrap by vector</i> to view the plots and the results.
</p>

<p>
screenshots of how the tank is shown on paraview are:
</p>


<div id="org58f3294" class="figure">
<p><img src="./pscreen.png" alt="pscreen.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-org80297f7" class="outline-2">
<h2 id="org80297f7"><span class="section-number-2">6.</span> final</h2>
<div class="outline-text-2" id="text-6">
<p>
what surprised me about FEM results, is that at pressure 0 point the deflection <i>u</i> is also near zero.
</p>

<p>
It is like near higher pressure does not affect nearby region so much.
</p>

<p>
The area affected it depends on thickness , but much more on the <i>modulus E</i>.
</p>

<p>
So a thin and elastic material is not affected overall by a force applied to a point. The only region affected is near the area force is applied. The rest of the structure is like no force never applied.
</p>

<p>
Above conclusion is validated by analytic equation of pressure of thin shell cylinder, which goes like:
</p>

<p>
\[\Delta R = \frac{q\cdot R^2}{E \cdot t}\], where q the pressure at height.
</p>

<p>
There is no variable of \(z\) height on above equations.
</p>

<p>
To visualize the above, there is a cylinder, holded on both edges, at constant pressure at the walls. The area that has some gradient on displacement, is near the ends, where the displacement changes from <i>0</i> to \(\Delta R\).
</p>



<div id="org78b874f" class="figure">
<p><img src="./results_problem_at_the_middle.png" alt="results_problem_at_the_middle.png" />
</p>
</div>
</div>
</div>



<div id="outline-container-org57b66e0" class="outline-2">
<h2 id="org57b66e0"><span class="section-number-2">7.</span> add a hole</h2>
<div class="outline-text-2" id="text-7">
<p>
To add a hole I tried to code a .geo file, but it was not sucessful, mostly because it was a surface.
</p>

<p>
So I modelled it on freecad, the procedure was:
</p>

<ul class="org-ul">
<li>sketch a circle and extrude <i>pad</i>.</li>
<li>sketch at a perpendicular plane the holes and <i>pocket</i>.</li>
<li>explode the compound to get the external surface</li>
<li>export the surface to .step</li>
<li>import the .step to gmsh</li>
<li>mesh the surface and export .msh</li>
<li>convert to elmer mesh</li>
<li>open ElmerGUI to find the new boundaries and bodies.</li>
<li>adjust the sif file to the new conditions</li>
<li>run the solver</li>
<li>view the results on paraview</li>
</ul>



<div id="org9b1a8d7" class="figure">
<p><img src="./pressure_on_walls_with_hole.png" alt="pressure_on_walls_with_hole.png" />
</p>
</div>


<p>
The lower hole is not moved because I added <i>u=0</i> boundary condition. The most accurate is to add a thick tube as solid material. 
</p>

<p>
Also tht vertical boundary that export the plot, it at 90degrees to the holes, and it is little affected by the stresses on the holes.
</p>


<div id="orgce00e6c" class="figure">
<p><img src="./plot_with_holes.png" alt="plot_with_holes.png" />
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2025-02-15 Sat 12:29</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
